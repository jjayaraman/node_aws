service: lambda-authoriser
frameworkVersion: '3'

provider:
  name: aws
  runtime: nodejs16.x
  region: eu-west-2
  memorySize: 128
  timeout: 20
  httpApi:
    authorizers:
      customAuthorizer:
        type: request
        functionName: authoriser
    metrics: true
    cors: true

custom:
  logRetentionInDays: 1

plugins:
  - serverless-plugin-typescript
  - serverless-plugin-log-retention

functions:
  authoriser:
    handler: src/authoriser/handler.authoriser
    environment:
      ACCOUNT_ID: ${aws:accountId}
      REGION: ${aws:region}
      HTTP_API_ID: ${aws:httpApiId}
  hello:
    handler: src/hello/handler.hello
    events:
      - httpApi:
          path: /hello
          method: get
          authorizer:
            name: customAuthorizer

    
